<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no, user-scalable=no">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script
      src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
      integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
      crossorigin="anonymous"></script>
    <script src="./StartAudioContext.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/13.0.1/Tone.min.js"></script>

    <link rel="stylesheet" href="./styles.css">

    <title>In case of loss, please return to:</title>

    <link rel="icon" type="image/png" href="assets/favicon.png">
  </head>

  <!-- pop-up instructions -->
  <div id="popup-overlay">
    <div id="popup-container">
      <button id="close-popup">Enter</button>
      <img src="assets/welcome.png" alt="welcome id="popup-image">
    </div>
  </div>
    
  <body>
    <div id="sidebar-index">
      <div id="sidebar-index-title">EXPLORER</div>
      <div id="sidebar-scroll">
        <!-- Entries will be injected here via JS -->
      </div>
    </div>
    
    <!-- Fixed page title -->
    <div id="fixed-header">
      <a href="https://enyajpan.github.io/in-case-of-loss/" target="_top">
        In case of loss, please return to:
      </a>
    </div>
    
    <div id="sort-controls">    

    <!-- Fixed header row -->
    <div id="fixed-th">
      <div class="line header-line">
        <div class="column number">#</div>
        <div class="column message">
          <span class="header-label">Message:</span>
          <button id="sort-button" class="sort-button">Sort: Oldest First ↑</button>
        </div>             
        <div class="column author">From:</div>           
        <div class="column label">Label:</div> 
        <div class="column timestamp">Time:</div>
      </div>
    </div>

      <!-- Scrollable area -->
      <div id="scroll-wrapper">
        <div id="container-wrapper">
          <div id="container">
            <!-- message entries will be inserted here dynamically -->
          </div>
        </div>
      </div>


    <div id="container-wrapper">
      <a href="https://enyajpan.github.io/404-error/" id="link-404">
        <img 
          id="background-404" 
          src="assets/404-error-background.png" 
          alt="404 error background" 
          oncontextmenu="return false;"
        />
      </a>      

      <img 
        id="container-bg" 
        src="assets/view-all-background.png" 
        alt="view all background" 
        oncontextmenu="return false;"
      />

      <img 
        id="about-overlay" 
        src="assets/about.png" 
        alt="about background" 
        oncontextmenu="return false;"
      />
    </div>

    <div id="submission-wrapper">
      <img 
        id="submission-bg" 
        src="assets/submission-form-background.png" 
        alt="submission form background" 
        oncontextmenu="return false;" 
      />
      <div id="submission-overlay">
        <form id="submission-form" novalidate>
          <!-- Checkboxes -->
          <div class="label-wrapper">
            <div class="label-title">What type of loss was it?</div>
            <div class="label-column">
              <label class="custom-checkbox">
                <input type="checkbox" name="label" value="missed-connections" />
                <span class="checkmark"></span>
                <span class="label-text" data-tooltip="An encounter with another where you briefly connect, experience a spark, but fail to exchange contact information, leading to a desire to reconnect.">missed.connections</span>
              </label>
              <label class="custom-checkbox">
                <input type="checkbox" name="label" value="past-lives" />
                <span class="checkmark"></span>
                <span class="label-text" data-tooltip="A previously lived life, or perhaps a life in another dimension—the 'what could have been' had you had chosen differently. You know you can no longer go back, but you will forever dream and reminisce and carry the longing for a life or version of yourself that could never come true.">past.lives</span>
              </label>
              <label class="custom-checkbox">
                <input type="checkbox" name="label" value="404-error" />
                <span class="checkmark"></span>
                <span class="label-text" data-tooltip="A broken link, corrupted file, loss of access. When you can no longer find what you're seeking. Perhaps they (it) no longer exist(s), or perhaps they've (it) already severed all ties. Or, maybe it's you the one breaking the link — would you choose to remember or to forget?">404.error</span>
              </label>
              <label class="custom-checkbox">
                <input type="checkbox" name="label" value="servant-of-sadness" />
                <span class="checkmark"></span>
                <span class="label-text" data-tooltip="description">servant.of.sadness</span>
              </label>
            </div>
            <span class="error-message" id="error-label"></span>
          </div>

          <!-- Stack subject + author -->
          <input name="number" type="hidden" />
          <div class="input-stack">
            <input name="subject line" placeholder="Subject" required />
            <span class="error-message" id="error-subject"></span>
            <input name="author" placeholder="Your name" required />
            <span class="error-message" id="error-author"></span>
          </div>          

          <!-- Message -->
          <div class="message-wrapper">
            <textarea 
              name="message" 
              placeholder="If you are brave enough to tell the world, what do you feel like you have lost?
Use this space to tell your story however you wish."
              required
            ></textarea>
            <span class="error-message" id="error-message"></span>
          </div>

          <button type="post">Post</button>
        </form>                          
      </div>
    </div>
    <button id="close-submission-form" class="close-button">x</button>

    <div id="spacer"></div>
      </div>
      <script>
        function scrambleText(el, originalText) {
          const chars = "!<>-_\\/[]{}—=+*^?#________";
          const duration = 600;
          const steps = 20;
          let frame = 0;
      
          const scrambleInterval = setInterval(() => {
            let output = "";
      
            for (let i = 0; i < originalText.length; i++) {
              if (frame > steps) {
                output += originalText[i];
              } else if (Math.random() < frame / steps) {
                output += originalText[i];
              } else {
                output += chars[Math.floor(Math.random() * chars.length)];
              }
            }
      
            el.textContent = output;
            frame++;
      
            if (frame > steps) {
              clearInterval(scrambleInterval);
            }
          }, duration / steps);
        }
      
        document.querySelectorAll('.scramble').forEach(el => {
          const originalText = el.textContent;
          el.addEventListener('mouseenter', () => {
            scrambleText(el, originalText);
          });
        });
      </script>
    
    <!-- Thank You Popup -->
    <div id="thank-you-popup" style="display: none;">
      <div class="popup-content">
        <button id="close-thank-you">Close</button>
        <img src="assets/thank-you.png" alt="Thank you" />
      </div>
    </div>


    </body>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script src="./script.js"></script>
</html>
